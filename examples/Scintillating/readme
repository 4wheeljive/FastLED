Work in progress.

This is a port of:

https://wokwi.com/projects/289631971594732040