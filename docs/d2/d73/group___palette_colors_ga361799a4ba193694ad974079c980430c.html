<!-- HTML header for doxygen 1.9.3-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FastLED: nblendPaletteTowardPalette</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../fastled_logo.png" type="image/svg+xml" rel="shortcut icon" />
<link href="../../style.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript">DoxygenAwesomeDarkModeToggle.init()</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">FastLED<span id="projectnumber">&#160;3.9.15</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('d2/d73/group___palette_colors_ga361799a4ba193694ad974079c980430c.html','../../'); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="contents">
<a id="ga361799a4ba193694ad974079c980430c" name="ga361799a4ba193694ad974079c980430c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga361799a4ba193694ad974079c980430c">&#9670;&#160;</a></span>nblendPaletteTowardPalette()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void nblendPaletteTowardPalette </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/dc4/class_c_r_g_b_palette16.html">CRGBPalette16</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>currentPalette</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/dc4/class_c_r_g_b_palette16.html">CRGBPalette16</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>targetPalette</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>maxChanges</em></span><span class="paramdefsep"> = </span><span class="paramdefval">24</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Alter one palette by making it slightly more like a "target palette". </p>
<p>Used for palette cross-fades.</p>
<p>It does this by comparing each of the R, G, and B channels of each entry in the current palette to the corresponding entry in the target palette and making small adjustments:</p><ul>
<li>If the CRGB::red channel is too low, it will be increased.</li>
<li>If the CRGB::red channel is too high, it will be slightly reduced.</li>
</ul>
<p>...and so on and so forth for the CRGB::green and CRGB::blue channels.</p>
<p>Additionally, there are two significant visual improvements to this algorithm implemented here. First is this:</p><ul>
<li>When increasing a channel, it is stepped up by ONE.</li>
<li>When decreasing a channel, it is stepped down by TWO.</li>
</ul>
<p>Due to the way the eye perceives light, and the way colors are represented in RGB, this produces a more uniform apparent brightness when cross-fading between most palette colors.</p>
<p>The second visual tweak is limiting the number of changes that will be made to the palette at once. If all the palette entries are changed at once, it can give a muddled appearance. However, if only a <em>few</em> palette entries are changed at once, you get a visually smoother transition: in the middle of the cross-fade your current palette will actually contain some colors from the old palette, a few blended colors, and some colors from the new palette.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">currentPalette</td><td>the palette to modify </td></tr>
    <tr><td class="paramname">targetPalette</td><td>the palette to move towards </td></tr>
    <tr><td class="paramname">maxChanges</td><td>the maximum number of possible palette changes to make to the color channels per call. The limit is 48 (16 color entries times 3 channels each). The default is 24, meaning that only half of the palette entries can be changed per call. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>The palette passed as <code>currentPalette</code> will be modified! Be sure to make a copy beforehand if needed. </dd></dl>
<dl class="todo"><dt><b><a class="el" href="../../dd/da0/todo.html#_todo000007">Todo</a></b></dt><dd>Shouldn't the <code>targetPalette</code> be <code>const</code>? </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../da/d2d/colorutils_8cpp_source.html#l01365">1365</a> of file <a class="el" href="../../da/d2d/colorutils_8cpp_source.html">colorutils.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1366</span>{</div>
<div class="line"><span class="lineno"> 1367</span>    uint8_t* p1;</div>
<div class="line"><span class="lineno"> 1368</span>    uint8_t* p2;</div>
<div class="line"><span class="lineno"> 1369</span>    uint8_t  changes = 0;</div>
<div class="line"><span class="lineno"> 1370</span> </div>
<div class="line"><span class="lineno"> 1371</span>    p1 = (uint8_t*)current.entries;</div>
<div class="line"><span class="lineno"> 1372</span>    p2 = (uint8_t*)target.entries;</div>
<div class="line"><span class="lineno"> 1373</span> </div>
<div class="line"><span class="lineno"> 1374</span>    <span class="keyword">const</span> uint8_t totalChannels = <span class="keyword">sizeof</span>(<a class="code hl_class" href="../../d2/dc4/class_c_r_g_b_palette16.html">CRGBPalette16</a>);</div>
<div class="line"><span class="lineno"> 1375</span>    <span class="keywordflow">for</span>( uint8_t i = 0; i &lt; totalChannels; ++i) {</div>
<div class="line"><span class="lineno"> 1376</span>        <span class="comment">// if the values are equal, no changes are needed</span></div>
<div class="line"><span class="lineno"> 1377</span>        <span class="keywordflow">if</span>( p1[i] == p2[i] ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><span class="lineno"> 1378</span> </div>
<div class="line"><span class="lineno"> 1379</span>        <span class="comment">// if the current value is less than the target, increase it by one</span></div>
<div class="line"><span class="lineno"> 1380</span>        <span class="keywordflow">if</span>( p1[i] &lt; p2[i] ) { ++p1[i]; ++changes; }</div>
<div class="line"><span class="lineno"> 1381</span> </div>
<div class="line"><span class="lineno"> 1382</span>        <span class="comment">// if the current value is greater than the target,</span></div>
<div class="line"><span class="lineno"> 1383</span>        <span class="comment">// increase it by one (or two if it&#39;s still greater).</span></div>
<div class="line"><span class="lineno"> 1384</span>        <span class="keywordflow">if</span>( p1[i] &gt; p2[i] ) {</div>
<div class="line"><span class="lineno"> 1385</span>            --p1[i]; ++changes;</div>
<div class="line"><span class="lineno"> 1386</span>            <span class="keywordflow">if</span>( p1[i] &gt; p2[i] ) { --p1[i]; }</div>
<div class="line"><span class="lineno"> 1387</span>        }</div>
<div class="line"><span class="lineno"> 1388</span> </div>
<div class="line"><span class="lineno"> 1389</span>        <span class="comment">// if we&#39;ve hit the maximum number of changes, exit</span></div>
<div class="line"><span class="lineno"> 1390</span>        <span class="keywordflow">if</span>( changes &gt;= maxChanges) { <span class="keywordflow">break</span>; }</div>
<div class="line"><span class="lineno"> 1391</span>    }</div>
<div class="line"><span class="lineno"> 1392</span>}</div>
<div class="ttc" id="aclass_c_r_g_b_palette16_html"><div class="ttname"><a href="../../d2/dc4/class_c_r_g_b_palette16.html">CRGBPalette16</a></div><div class="ttdoc">RGB color palette with 16 discrete values.</div><div class="ttdef"><b>Definition</b> <a href="../../d1/dfb/colorutils_8h_source.html#l01004">colorutils.h:1004</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d1/dfb/colorutils_8h_source.html#l01006">CRGBPalette16::entries</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/df6/twinklefox_8h_source.html#l00125">fl::TwinkleFox::draw()</a>, and <a class="el" href="../../d4/dd0/_twinkle_fox_8ino_source.html#l00126">loop()</a>.</p>
<div id="dynsection-0" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d2/d73/group___palette_colors_ga361799a4ba193694ad974079c980430c_ga361799a4ba193694ad974079c980430c_icgraph.svg" width="412" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.3-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d2/d73/group___palette_colors.html">Palette Color Functions</a></li>
    <li class="footer">Generated on Fri Apr 18 2025 03:39:31 for FastLED by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
<!-- ... -->
</body>
</html>
