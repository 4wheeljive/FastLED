# This platformio is designed to be run in the docker container for our wasm compiler.

[env:wasm]
platform = native
extra_scripts = 
  post:wasm_compiler_flags.py
lib_compat_mode = off
build_flags =
  -std=c++17 
  -DFASTLED_ENGINE_EVENTS_MAX_LISTENERS=50
  -DFASTLED_FORCE_NAMESPACE=1
  -DFASTLED_USE_PROGMEM=0
  -DDISABLE_EXCEPTION_CATCHING=1
  -fno-exceptions
  -fno-rtti
  -DEMSCRIPTEN_HAS_UNBOUND_TYPE_NAMES=0
  -std=gnu++17
  -sUSE_PTHREADS=0
  -fpermissive
  -DFASTLED_NO_PINMAP
  -DHAS_HARDWARE_PIN_SUPPORT
  -DFASTLED_FORCE_SOFTWARE_SPI
  -DFASTLED_FORCE_NAMESPACE=1
  -I/precompiled/include        ; add the precompiled include directory
  -L/precompiled                ; add the precompiled library directory
  -v
  -lfastled                     ; link with libfastled.a (the lib prefix and .a suffix are implicit)
custom_wasm_export_name = fastled

build_dir = build/wasm
