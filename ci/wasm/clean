#!/bin/bash

# Cleans the fastled-wasm-compiler Docker image and related resources

# Function to filter and return Docker container IDs
filter_containers() {
    docker ps -a -q --filter ancestor=fastled-wasm-compiler 2>/dev/null || true
}

# Function to check if a container exists
container_exists() {
    [ -n "$(filter_containers)" ]
}

# Function to check if an image exists
image_exists() {
    docker image inspect fastled-wasm-compiler >/dev/null 2>&1
}

# Stop and remove containers related to fastled-wasm-compiler
if container_exists; then
    echo "Stopping and removing containers..."
    container_ids=$(filter_containers)
    
    if [ -n "$container_ids" ]; then
        docker stop $container_ids
        docker rm $container_ids
    else
        echo "No containers found for fastled-wasm-compiler."
    fi
else
    echo "No containers found for fastled-wasm-compiler."
fi

# Remove the fastled-wasm-compiler image
if image_exists; then
    echo "Removing fastled-wasm-compiler image..."
    docker rmi fastled-wasm-compiler
else
    echo "No image found for fastled-wasm-compiler."
fi
